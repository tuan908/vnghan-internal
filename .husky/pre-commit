#!/usr/bin/env sh

# Exit on any error
set -e

# Function to handle cleanup on exit
cleanup() {
    echo "ğŸ§¹ Pre-commit checks completed.\n"
}

# Set up trap for cleanup
trap cleanup EXIT

echo "ğŸ” Running pre-commit checks...\n"

echo "ğŸ“‹ Checking TypeScript types..."
# Use TypeScript compiler for type checking
pnpm exec tsc --noEmit 2>&1 || {
    echo "âŒ TypeScript check failed. Fix the errors and try again."
    exit 1
}
echo "âœ… TypeScript check passed.\n"

echo "ğŸ—ï¸ Running build check..."
pnpm build 2>&1 || {
    echo "âŒ Build failed. Fix the errors and try again."
    exit 1
}
echo "âœ… Build check passed.\n"

echo "ğŸ¨ Checking code formatting..."
# Format the code (this will modify files if needed)
pnpm format
echo "âœ… Code formatting applied.\n"

echo "âœ¨ All pre-commit checks passed!"
